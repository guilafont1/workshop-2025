{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Lobby</h2>
  <p><strong>Ã‰quipe :</strong> {{ state.team_name or "â€”" }}</p>
  <p><strong>Progression :</strong> {{ state.progress }}</p>
  <div style="margin-top:12px;padding-top:10px;border-top:1px dashed rgba(255,255,255,0.03)">
    <h3>Comment jouer</h3>
    <ol>
      <li>Lisez l'indice, chaque salle a un indice clair.</li>
      <li>Une fois une salle rÃ©ussie, la suivante se dÃ©bloque.</li>
      <li>Vous avez 35 minutes au total â€” travaillez ensemble et prenez votre temps.</li>
    </ol>
    <form method="post" action="{{ url_for('reset') }}" style="margin-top:8px">
      <button type="submit">RÃ©initialiser la partie</button>
    </form>
  </div>
  <div style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
    {# Room 1 always unlocked after start #}
    <a class="card" style="display:block;text-decoration:none;color:inherit" href="{{ url_for('room1') }}">ğŸ«€ Salle 1 â€” Diagnostic cardiaque</a>

    {# Room 2: unlocked only after room1 is complete #}
    {% if state.progress.room1 %}
      <a class="card" style="display:block;text-decoration:none;color:inherit" href="{{ url_for('room2') }}">ğŸ’Š Salle 2 â€” Prescriptions mÃ©dicales</a>
    {% else %}
      <div class="card disabled">ğŸ’Š Salle 2 â€” VerrouillÃ©e (finissez Salle 1)</div>
    {% endif %}

    {# Room 3: unlocked only after room2 is complete #}
    {% if state.progress.room2 %}
      <a class="card" style="display:block;text-decoration:none;color:inherit" href="{{ url_for('room3') }}">ğŸŒ¡ï¸ Salle 3 â€” Hydratation et tempÃ©rature</a>
    {% else %}
      <div class="card disabled">ğŸŒ¡ï¸ Salle 3 â€” VerrouillÃ©e (finissez Salle 2)</div>
    {% endif %}

    {# Room 4: unlocked only after room3 is complete #}
    {% if state.progress.room3 %}
      <a class="card" style="display:block;text-decoration:none;color:inherit" href="{{ url_for('room4') }}">ğŸ§¬ Salle 4 â€” Analyse gÃ©nÃ©tique virale</a>
    {% else %}
      <div class="card disabled">ğŸ§¬ Salle 4 â€” VerrouillÃ©e (finissez Salle 3)</div>
    {% endif %}

    {# Room 5: unlocked only after room4 is complete #}
    {% if state.progress.room4 %}
      <a class="card" style="display:block;text-decoration:none;color:inherit" href="{{ url_for('room5') }}">ğŸ¦  Salle 5 â€” Laboratoire de confinement</a>
    {% else %}
      <div class="card disabled">ğŸ¦  Salle 5 â€” VerrouillÃ©e (finissez Salle 4)</div>
    {% endif %}

    {# Room 6: unlocked only after room5 is complete #}
    {% if state.progress.room5 %}
      <a class="card" style="display:block;text-decoration:none;color:inherit" href="{{ url_for('room6') }}">ğŸ¥ Salle 6 â€” Patient zÃ©ro critique</a>
    {% else %}
      <div class="card disabled">ğŸ¥ Salle 6 â€” VerrouillÃ©e (finissez Salle 5)</div>
    {% endif %}
  </div>
</div>
{% endblock %}
